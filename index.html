<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>CROS</title>

        <link rel="icon"
              type="image/png"
              href="img/logo_icon.png">

		<link rel="stylesheet" href="css/normalize.css">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/theme.css">
        <link rel="stylesheet" href="css/style.css">
		<link rel="stylesheet" href="css/font-awesome.min.css">
		<link rel='stylesheet' href='css/nprogress.css'/>
		<link rel="stylesheet" href="css/leaflet.css" />
		<link rel="stylesheet" href="css/epoch.min.css" />
		<!-- link rel="stylesheet" href="css/epoch.css"-->
	</head>
	<body class="main page">
		<script type="text/x-handlebars" id="App">
			<div class="navbar navbar-default" id="navbar">
				<a class="navbar-brand" href="#"><img src="img/logo_small.png" style="height:50px;display:inline-block;" />ROS</a>
				{{#user-display action="logout"}}
                {{/user-display}}
			</div>
			<div id="wrapper">
				<section id="sidebar">
					<i class="glyphicon glyphicon-align-justify icon-large" id="toggle"></i>
					<ul id="dock">
						{{#link-to 'dashboard' tagName="li" href=false class="launcher"}}
							<i class="fa fa-tachometer"></i>
							{{#link-to 'dashboard'}}Dashboard{{/link-to}}
						{{/link-to}}
						{{#link-to 'drones' tagName="li" href=false class="launcher"}}
							<i class="fa fa-dot-circle-o"></i>
							{{#link-to 'drones'}}Drones{{/link-to}}
						{{/link-to}}
						{{#link-to 'assignments' tagName="li" href=false class="launcher"}}
							<i class="fa fa-file-text-o"></i>
							{{#link-to 'assignments'}}Assignments{{/link-to}}
						{{/link-to}}
						{{#link-to 'basestations' tagName="li" href=false class="launcher"}}
							<i class="fa fa-home"></i>
							{{#link-to 'basestations'}}Basestations{{/link-to}}
						{{/link-to}}
						{{#link-to 'users' tagName="li" href=false class="launcher"}}
							<i class="fa fa-user"></i>
							{{#link-to 'users'}}Users{{/link-to}}
						{{/link-to}}
					</ul>
				</section>

				<!--Toolbar-->
				<section id="tools" style="height:51px;" {{bind-attr class="notificationType"}}>
					<div id="notificationSlider">
						<i class="fa fa-info-circle"></i> 
						{{notification.message}}
						<button type="button" class="close" aria-label="Close" {{action 'dismiss'}}><span aria-hidden="true">&times;</span></button>
					</div>
				</section>

				<!--Content-->>
				<section id="content">
					{{outlet}}
					{{outlet 'modal'}}
				</section>
			</div>
		</script>

		<script type="text/x-handlebars" id="dashboard">
            <div class="row">
                <div class="col-md-6">
                    <div class="well">
						<ul class="list-group">
							<li class="list-group-item text-center notifications-title"><b>Notifications</b></li>
							<div class="row">
								<div class="col-xs-12">
									<div class="scroll">
										{{#if notificationsAvailable}}
											{{#each item in notifications}}
												<a href="javascript:;" class="list-group-item extra-padding" {{ action 'notificationClicked' item}}>
													{{#unless item.seen}} <span class="badge">new</span>{{/unless}}
													<b>#{{item.number}}:</b> {{item.message}} 
													<span class="time">{{item.time}}</span>
												</a>
											{{/each}}	
										{{else}}
											<li class="list-group-item text-center no-notifications">no notifications to show</li>
										{{/if}}
									</div>
									<button {{bind-attr class=":btn :btn-xs :pull-right isEnabled:enabled:disabled"}} {{ action 'removeSeenNotifications'}}>Remove seen notifications</button>
								</div>
							</div>
						</ul>
                    </div>
                </div>
				<div class="col-md-6">
					<div class="well">
						{{dashboard-map mapName="dashboardMap" location=locations}}
					</div>
				</div>
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="well">
                        <div class="row">
                            <div class="col-sm-9">
                                {{pie-chart data=statuses total=total}}
                            </div>
                            <div class="col-sm-3" id="legend">
                                <h5><span class="label label-unavailable">Unavailable</span></h5>
                                <h5><span class="label label-available">Available</span></h5>
                                <h5><span class="label label-inflight">In flight</span></h5>
                                <h5><span class="label label-charging">Charging</span></h5>
                                <h5>Total: {{total}}</h5>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
		</script>

        <script type="text/x-handlebars" id="drones">
            {{#my-table columns=columns data=model length=model.total action="getPage" searchFields=searchFields addLink="drones-add" userCanEdit=userCanEdit}}
                {{#each item in model.resource itemController='drone'}}
                    <tr>
                        <td>{{item.id}}</td>
                        <td>{{item.name}}</td>
                        <td><span {{bind-attr class="item.getModelClass"}}>{{item.status}}</span></td>
                        <td>
                            <a class='btn-sm btn-warning' href='#' {{action 'emergency' item.id}}>
                            EMERGENCY
                            </a>
                        </td>
                        <td class='action'>
                            <div class="btn-group">
                                {{#link-to 'drone' item.id class='btn btn-success'}}
                                <i class="fa fa-search"></i>
                                {{/link-to}}
                                {{#link-to 'drone-edit' item.id class='btn btn-info' tag="button" disabled=userCantEdit}}
                                    <i class="fa fa-pencil"></i>
                                {{/link-to}}
                                <button class='btn btn-danger' href="javascript:;" {{action 'delete' item.id}} {{bind-attr disabled=userCantEdit}}>
                                    <i class="fa fa-trash-o"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                {{/each}}
            {{/my-table}}
        </script>
		
		<script type="text/x-handlebars" id="drone-edit">
			{{#popup-window title="Add drone" link='drones' ok='save' saveButton=true}}
				<div class="row">
					<div id="droneAddAlert" class="col-xs-12"></div>
				</div>
				<form {{action 'ok' on='submit' target=view}}>
					<div class="form-group">
						<div class="row">
							<div class="col-xs-8"><label>Name:</label></div>
						</div>
						<div class="well">
							<div class="row">
								<div {{bind-attr class=":col-xs-12 hasNameError:has-error"}}>
									{{#if hasNameError}}<label class="control-label">{{ nameError }}</label>{{/if}}
									{{input  placeholder="Name" class="form-control" value=model.name}}
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Address:</label></div>
						</div>
						<div class="well">
							<div class="row">
								<div {{bind-attr class=":col-xs-12 hasAddressError:has-error"}}>
									{{#if hasAddressError}}<label class="control-label">{{ addressError }}</label>{{/if}}
									{{input  placeholder="Address" class="form-control" value=model.address}}
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-12"><label>Type:</label></div>
						</div>
						<div class="well">
							<div class="row">
								<div id="typeSelector" {{bind-attr class=":col-xs-12 hasTypeError:has-error"}}>
									{{#if hasTypeError}}<label class="control-label">{{ typeError }}</label>{{/if}}
									<select class="form-control" {{action 'updateType' on='change'}}>
										{{#each type in types itemController="type"}}
											<option {{bind-attr value=type.type selected=type.selected }}>{{type.type}} ({{type.versionNumber}})</option>
										{{/each}}
									</select>
								</div>
							</div>
						</div>
						<label>
							<a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Advanced</a>
						</label>
						<div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
							<div class="row">
								<div class="col-xs-8"><label>Weight limitation:</label></div>
							</div>
							<div class="well">
								<div class="row">
									<div {{bind-attr class=":col-xs-12 hasWeightError:has-error"}}>
										{{#if hasWeightError}}<label class="control-label">{{ weightError }}</label>{{/if}}
										<div class="input-group">
											{{input placeholder="Weight Limitation" type="number" class="form-control" value=model.weightLimitation}}
											<div class="input-group-addon">kg</div>
										</div>
									</div>
								</div>
							</div>
                            <div class="well">
                                <div class="row">
                                    <div {{bind-attr class=":col-xs-12 hasStateError:has-error"}}>
                                        {{#if hasStateError}}<label class="control-label">{{ stateError }}</label>{{/if}}
                                        <div id="droneStatus" class="btn-group btn-group-justified" data-toggle="buttons">
                                            <label {{bind-attr class=":btn :btn-success isAvailableState:active"}} {{action 'setState' "AVAILABLE" }}>
                                                <input type="radio" name="available" id="available" autocomplete="off" {{bind-attr checked="isAvailableState"}}>
                                                Available
                                            </label>
                                            <label {{bind-attr class=":btn :btn-success isChargingState:active"}} {{action 'setState' "CHARGING" }}>
                                                <input type="radio" name="charging" id="charging" autocomplete="off" {{bind-attr checked="isChargingState"}}>
                                                Charging
                                            </label>
                                            <label {{bind-attr class=":btn :btn-success isInactiveState:active"}} {{action 'setState' "INACTIVE" }}>
                                                <input type="radio" name="inactive" id="inactive" autocomplete="off" {{bind-attr checked="isInactiveState"}}>
                                                Inactive
                                            </label>
                                            <label {{bind-attr class=":btn :btn-success isRetiredState:active"}} {{action 'setState' "RETIRED" }}>
                                                <input type="radio" name="retired" id="retired" autocomplete="off" {{bind-attr checked="isRetiredState"}}>
                                                Retired
                                            </label>
                                            <label {{bind-attr class=":btn :btn-success isManualState:active"}} {{action 'setState' "MANUAL_CONTROL" }}>
                                                <input type="radio" name="manual" id="manual" autocomplete="off" {{bind-attr checked="isManualState"}}>
                                                Manual control
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
						</div>
					</div>
				</form>
			{{/popup-window}}
		</script>

		<script type="text/x-handlebars" id="drone">
			{{#popup-window title=model.name size="80%" footer='<div class="battery"><div class="batteryStatus"></div></div>' link='drones' saveButton=false}}
                <div class="row">
                    <div class="col-xs-2"></div>
                    <div class="col-xs-8 text-center whitespaceBottom">
                        {{#if hasControlError}}
                        <div {{bind-attr class="hasControlError:has-error"}}>
                            <label class="control-label">{{ controlError }}</label>
                        </div>
                        {{/if}}
                        <div class="btn-group" data-toggle="buttons">
                            <label {{bind-attr class=":btn :btn-success automatic:active"}} {{action 'setAutomatic'}}>
                                <input type="radio" name="automatic" id="automatic" autocomplete="off" {{bind-attr checked="automatic"}}>
                                <i class="fa fa-magic"></i> Automagic
                            </label>
                            <label {{bind-attr class=":btn :btn-success manual:active"}}  {{action 'setManual'}}>
                                <input type="radio" name="manual" id="manual" autocomplete="off" {{bind-attr checked="manual"}}>
                                <i class="fa fa-gamepad"></i> Manual Control
                            </label>
                        </div>
                    </div>
                    <div class="col-xs-2">
                        <a class='btn-sm btn-warning' href='#' {{action 'emergency' model.id}}>
                            EMERGENCY
                        </a>
                    </div>
                </div>
                {{partial "droneAutomatic" }}
                {{partial "droneManual" }}
			{{/popup-window}}
		</script>

        <script type="text/x-handlebars" id="_droneAutomatic">
            <div {{bind-attr class=":row automatic:show:hidden"}}>
                <div class="col-sm-6">
                    <div class="well">
                        <div class="row">
                            <div class="col-xs-8"><label>Address:</label></div>
                            <div class="col-xs-4">{{model.address}}</div>
                        </div>
                        <div class="row">
                            <div class="col-xs-8"><label>Type:</label></div>
                            <div class="col-xs-4">{{model.droneType.type}}</div>
                        </div>
                        <div class="row">
                            <div class="col-xs-8"><label>Version number:</label></div>
                            <div class="col-xs-4">{{model.droneType.versionNumber}}</div>
                        </div>
                        <div class="row">
                            <div class="col-xs-8"><label>Status:</label></div>
                            <div class="col-xs-4"><span {{bind-attr class="getModelClass"}}>{{model.status}}</span></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-8"><label>Weight limitation:</label></div>
                            <div class="col-xs-4">{{model.weightLimitation}}</div>
                        </div>
                        <div class="row">
                            <div class="col-xs-8"><label>Altitude:</label></div>
                            <div class="col-xs-4">{{altitude}}</div>
                        </div>
                        <div class="row">
                            <div class="col-xs-8"><label>Altitude:</label></div>
                        </div>
                        <div class="row">
                            <div class="col-xs-3" style="padding-top: 7%">
                                {{gauge-graph drone=model.id}}
                            </div>
                            <div class="col-xs-9" style="padding-right: 0px">
                                {{#line-graph drone=model.id}}{{/line-graph}}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-6">
                    {{#drone-map mapName="droneMap" location=location updateSize=automatic}}{{/drone-map}}
                </div>
            </div>
        </script>

        <script type="text/x-handlebars" id="_droneManual">
            <div {{bind-attr class=":row :manualController automatic:hidden:show"}}>
                <div class="col-xs-12">
                    <div class="row whitespaceBottom">
                        <div class="col-md-6">
                            {{#if streamingVideo}}
                                <img src="" />
                            {{else}}
                                <div class="videoClick text-center">
                                    <button class="btn btn-lg btn-default" {{action 'initVideo'}} style="vertical-align: middle" >
                                        <i class='fa fa-play-circle'></i>
                                    </button>
                                </div>
                            {{/if}}

                        </div>
                        <div class="col-md-6">
                            {{#drone-map mapName="droneControlMap" location=location updateSize=automatic}}{{/drone-map}}
                        </div>
                    </div>
                    <div class="row text-center">
                        <div class="col-md-3">
                            <div class="btn-group-vertical">
                                {{#manual-control title="Outdoor" currentId=model.id command="setOutdoor" error=controlError}}{{/manual-control}}
                                {{#manual-control title="Indoor" currentId=model.id command="setIndoor" error=controlError}}{{/manual-control}}
                            </div>
                            <div class="btn-group-vertical">
                                {{#manual-control title="Hull" currentId=model.id command="setHull" error=controlError}}{{/manual-control}}
                                {{#manual-control title="No hull" currentId=model.id command="setNoHull" error=controlError}}{{/manual-control}}
                            </div>
                        </div>
                        <div class="col-md-6">
                            {{partial "directionControls"}}
                        </div>
                        <div class="col-md-3">
                            {{#manual-control title="Flat trim" currentId=model.id command="flatTrim" error=controlError}}{{/manual-control}}
                            <div class="input-group">
                                <span class="input-group-addon" id="basic-addon1">Speed ({{speedString}})</span>
                                {{input class="form-control" id="speed" value=speedvalue min="0" max="1" step="0.01" placeholder='Speed' type='range'}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </script>

        <script type="text/x-handlebars" id="_directionControls">
            <div class="row">
                <div class="col-xs-4 controlButtonContainerParent" style="width:32%">
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control class="" title="Flip Left" currentId=model.id command="flipLeft" key="d" error=controlError}}{{/manual-control}}
                    </div></div>
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="<i class='fa fa-undo'></i>" currentId=model.id command="rotateLeft" key="%" error=controlError}}{{/manual-control}}
                        {{#manual-control title="<i class='fa fa-arrow-left'></i>" currentId=model.id command="moveLeft" key="Q" error=controlError}}{{/manual-control}}
                    </div></div>
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="Flip Backward" currentId=model.id command="flipBack" key="b" error=controlError}}{{/manual-control}}
                    </div></div>
                </div>
                <div class="col-xs-4 controlButtonContainerParent" style="width:32%">
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="<i class='fa fa-arrow-up'></i>" currentId=model.id command="moveForward" key="Z" error=controlError}}{{/manual-control}}
                        {{#manual-control title="<i class='glyphicon glyphicon-triangle-top'></i>" currentId=model.id command="moveUp" key="A" error=controlError}}{{/manual-control}}
                    </div></div>
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="<i class='fa fa-circle'></i>" currentId=model.id command="center" error=controlError}}{{/manual-control}}
                    </div></div>
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="<i class='fa fa-arrow-down'></i>" currentId=model.id command="moveBackward" key="S" error=controlError}}{{/manual-control}}
                        {{#manual-control title="<i class='glyphicon glyphicon-triangle-bottom'></i>" currentId=model.id command="moveDown" key="E" error=controlError}}{{/manual-control}}
                    </div></div>
                </div>
                <div class="col-xs-4" style="width:32%">
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="Flip Forward" currentId=model.id command="flipFront" key="h" error=controlError}}{{/manual-control}}
                    </div></div>
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="<i class='fa fa-arrow-right'></i>" currentId=model.id command="moveRight" key="D" error=controlError}}{{/manual-control}}
                        {{#manual-control title="<i class='fa fa-repeat'></i>" currentId=model.id command="rotateRight" key="'" error=controlError}}{{/manual-control}}
                    </div></div>
                    <div class="row"><div class="btn-group btn-group-justified controlButtonContainer">
                        {{#manual-control title="Flip Right" currentId=model.id command="flipRight" key="f" error=controlError}}{{/manual-control}}
                    </div></div>
                </div>
            </div>
            <div class="row">
                <div class="col-xs-12" style="width:96%">
                    <div class="btn-group btn-group-justified" role="group">
                        {{#manual-control title="Take off" currentId=model.id command="takeOff" key="T" error=controlError}}{{/manual-control}}
                        {{#manual-control title="Land" currentId=model.id command="land" key="L" error=controlError}}{{/manual-control}}
                    </div>
                </div>
            </div>
        </script>

        <script type="text/x-handlebars" id="assignments">
            {{#my-table columns=columns data=model length=model.total action="getPage" searchFields=searchFields addLink="assignments-add" userCanEdit=userCanEdit}}
            {{#each item in model.resource}}
            <tr>
                <td>{{item.id}}</td>
                <td>{{item.priority}}</td>
                <td>{{item.creator.email}}</td>
                <td>{{item.assignedDrone.name}}</td>
                <td class='action'>
                    <div class="btn-group">
                        {{#link-to 'assignment' item.id class='btn btn-success'}}
                            <i class="fa fa-search"></i>
                        {{/link-to}}
                        <button class='btn btn-danger' href="javascript:;" {{action 'delete' item.id}} {{bind-attr disabled=userCantEdit}}>
                            <i class="fa fa-trash-o"></i>
                        </button>
                    </div>
                </td>
            </tr>
            {{/each}}
            {{/my-table}}
        </script>

		<script type="text/x-handlebars" id="assignments-add">
			{{#popup-window title="Create assignment" size="80%" link='assignments' ok='save' saveButton=true}}
				<div class="row">
					<div id="assignmentAddAlert" class="col-xs-12"></div>
				</div>
                <div class="row">
                    <div class="col-sm-7">
                        <form {{action 'ok' on='submit' target=view}}>
                        <div class="row">
                            <div class="col-xs-6"><label>Route:</label></div>
                            <div class="col-xs-6 text-right">
                                {{view "select" id="basestationSelect" content=basestations optionValuePath="content.id" optionLabelPath="content.name" prompt="Checkpoint" value=selected}}
                                <button {{action 'add' true}} style="line-height:0; font-size:10px" class="btn btn-xs">
                                <i class="fa fa-plus"></i>
                                <label id="addButtonText">Add</label>
                                </button>
                            </div>
                        </div>
                        <div id="routesAssignment">
                            {{#each checkpoint in checkpoints itemController="checkpoint"}}
                            {{#unless checkpoint.isFirstCheckpoint}}
                            <div class="row text-center">
                                <button  {{action "swap" checkpoint.id}} class="btn btn-xs btn-swap">
                                <i class="fa fa-arrows-v"></i>
                                </button>
                            </div>
                            {{/unless}}
                            <div class="well route-well">
                                <div class="row">
									<div class="col-lg-12"><a href="javascript:;" {{action 'remove' checkpoint.id}} class="remove close">&times;</a></div>
                                    <div class="col-sm-6 col-lg-3">{{input class='longitude form-control' placeholder='Longitude' type='number' value=checkpoint.longitude}}</div>
                                    <div class="col-sm-6 col-lg-3">{{input class='latitude form-control' placeholder='Latitude' type='number' value=checkpoint.latitude}}</div>
                                    <div class="col-sm-6 col-lg-3">{{input class='altitude form-control' placeholder='Altitude' type='number' value=checkpoint.altitude}}</div>
                                    <div class="col-sm-6 col-lg-3">
										<div class="input-group">
											{{input class='waitingTime form-control' placeholder='Wait time' type='number' value=checkpoint.waitingTime}}
											<div class="input-group-addon">s</div>
										</div>
									</div>
                                </div>
                            </div>
                            {{/each}}
                        </div>
                        <label>
                            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Advanced</a>
                        </label>
                        <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
                            <div class="row">
                                <div class="col-xs-8"><label>Priority:</label></div>
                            </div>
                            <div class="well">
                                <div class="row">
                                    <div class="col-xs-12">{{input class="form-control" value=priority}}</div>
                                </div>
                            </div>
                        </div>
                        </form>
                    </div>
                    <div class="col-sm-5">
                        {{#assignments-add-map mapName="assignmentsAddMap" location=locations}}{{/assignments-add-map}}
                    </div>
                </div>
			{{/popup-window}}
		</script>

		<script type="text/x-handlebars" id="assignment">
			{{#popup-window title="Assignment"  size="60%" link='assignments' saveButton=false}}
				<div class="row">
					<div class="col-xs-6">
						<div class="row">
							<div class="col-xs-8"><label>Creator:</label></div>
							<div class="col-xs-4">{{#link-to 'user' model.creator.id}}{{model.creator.firstName}} {{model.creator.lastName}}{{/link-to}}</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Creator e-mail:</label></div>
							<div class="col-xs-4">{{model.creator.email}}</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Assigned drone:</label></div>
							<div class="col-xs-4">{{#link-to 'drone' model.assignedDrone.id}} {{model.assignedDrone.name}} {{/link-to}}</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Priority:</label></div>
							<div class="col-xs-4">{{model.priority}}</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Progress:</label></div>
							<div class="col-xs-4"><span {{bind-attr class=":label progressLabel"}}>{{progressText}}</span></div>
						</div>
					</div>
					<div class="col-xs-6">
                        {{assignment-map mapName="assignment" location=checkpointLocations droneLocation=droneLocation progress=model.progress}}
					</div>
				</div>
			{{/popup-window}}
		</script>

        <script type="text/x-handlebars" id="basestations">
            {{#my-table columns=columns data=model length=model.total action="getPage" searchFields=searchFields addLink="basestations-add" userCanEdit=userCanEdit}}
            {{#each item in model.resource}}
            <tr>
                <td>{{item.id}}</td>
                <td>{{item.name}}</td>
                <td class='action'>
                    <div class="btn-group">
                        {{#link-to 'basestation' item.id class='btn btn-success'}}
                        <i class="fa fa-search"></i>
                        {{/link-to}}
                        {{#link-to 'basestation-edit' item.id class='btn btn-info' tag="button" disabled=userCantEdit}}
                            <i class="fa fa-pencil"></i>
                        {{/link-to}}
                        <button class='btn btn-danger' href="javascript:;" {{action 'delete' item.id}} {{bind-attr disabled=userCantEdit}}>
                            <i class="fa fa-trash-o"></i>
                        </button>
                    </div>
                </td>
            </tr>
            {{/each}}
            {{/my-table}}
        </script>

        <script type="text/x-handlebars" id="basestations-edit">
            {{#popup-window title="Create basestation" link='basestations' ok='save' saveButton=true}}
                <form {{action 'ok' on='submit' target=view}}>
                <div class="row">
                    <div class="col-xs-12">
                        <div {{bind-attr class=":form-group hasNameError:has-error"}}>
                            {{#if hasNameError}}<label class="control-label" for="name">{{ nameError }}</label>{{/if}}
                            {{input class="form-control" id="name" value=model.name placeholder='Name'}}
                        </div>
                    </div>
                </div>
                {{#if hasSomeError}}
                    <div {{bind-attr class=":row hasSomeError:has-error" }} style="margin-top:10px">
                        {{#if hasLocationError}}
                            <div class="col-xs-12">
                                <label class="control-label has-error" for="location">{{ locationError }}</label>
                            </div>
                        {{/if}}
                        {{#if hasLongitudeError}}
                            <div class="col-xs-4">
                                <label class="control-label has-error" for="longitude">{{ longitudeError }}</label>
                            </div>
                        {{/if}}
                        {{#if hasLatitudeError}}
                            <div class="col-xs-4">
                                <label class="control-label has-error" for="Latitude">{{ latitudeError }}</label>
                            </div>
                        {{/if}}
                        {{#if hasAltitudeError}}
                            <div class="col-xs-4">
                                <label class="control-label has-error" for="Altitude">{{ altitudeError }}</label>
                            </div>
                        {{/if}}
                    </div>
                {{/if}}
                <div class="row" style="margin-top:10px">
                    <div {{bind-attr class=":form-group hasLocationError:has-error"}}>
                        <div {{bind-attr class=":col-sm-4 hasLongitudeError:has-error"}}>
                            {{input class="form-control" id="longitude" value=model.location.longitude placeholder='Longitude' type='number'}}
                        </div>
                        <div {{bind-attr class=":col-sm-4 hasLatitudeError:has-error"}}>
                            {{input class="form-control" id="latitude" value=model.location.latitude placeholder='Latitude' type='number'}}
                        </div>
                        <div {{bind-attr class=":col-sm-4 hasAltitudeError:has-error"}}>
                            {{input class="form-control" id="altitude" value=model.location.altitude placeholder='Altitude' type='number'}}
                        </div>
                    </div>
                </div>
                <div class="row" style="margin-top:10px">
                    <div class="col-xs-12">
                        {{#basestation-add-map mapName="basestationAddMap" location=location}}{{/basestation-add-map}}
                    </div>
                </div>
                </form>
            {{/popup-window}}
        </script>

		<script type="text/x-handlebars" id="basestation">
			{{#popup-window title=model.name link='basestations' saveButton=false}}
				<div class="row">
					<div class="col-xs-offset-1 col-xs-10">
						{{#basestation-map mapName="basestationMap" location=basestationLocation}}{{/basestation-map}}
					</div>
				</div>
			{{/popup-window}}
		</script>

        <script type="text/x-handlebars" id="users">
            {{#my-table columns=columns data=model length=model.total action="getPage" searchFields=searchFields addLink="users-add" userCanEdit=userCanEdit}}
            {{#each item in model.resource itemController="user"}}
            <tr>
                <td>{{item.id}}</td>
                <td>{{item.firstName}} {{item.lastName}}</td>
                <td>{{item.email}}</td>
                <td><span {{bind-attr class="item.getClass"}}>{{item.role}}</span></td>
                <td class='action'>
                    <div class="btn-group">
                        {{#link-to 'user' item.id class='btn btn-success'}}
                            <i class="fa fa-search"></i>
                        {{/link-to}}
                        {{#link-to 'user-edit' item.id class='btn btn-info' tag="button" disabled=userCantEdit}}
                            <i class="fa fa-pencil"></i>
                        {{/link-to}}
                        <button class='btn btn-danger' href="javascript:;" {{action 'delete' item.id}} {{bind-attr disabled=userCantEdit}}>
                            <i class="fa fa-trash-o"></i>
                        </button>
                    </div>
                </td>
            </tr>
            {{/each}}
            {{/my-table}}
        </script>

		<script type="text/x-handlebars" id="user-edit">
			{{#popup-window title="Add user" link='users' ok='save' saveButton=true}}
				<div class="row">
					<div id="userAddAlert" class="col-xs-12"></div>
				</div>
				<form {{action 'ok' on='submit' target=view}}>
					<div class="form-group">
						<div class="row">
							<div class="col-xs-8"><label>Full name:</label></div>
						</div>
						<div class="well">
							<div class="row">
								<div {{bind-attr class=":col-sm-6 hasFirstNameError:has-error"}}>
									{{#if hasFirstNameError}}<label class="control-label" for="name">{{ firstNameError }}</label>{{/if}}
									{{input  placeholder="First name" class="form-control" value=model.firstName}}
								</div>
								<div {{bind-attr class=":col-sm-6 hasLastNameError:has-error"}}>
									{{#if hasLastNameError}}<label class="control-label" for="name">{{ lastNameError }}</label>{{/if}}
									{{input  placeholder="Last name" class="form-control" value=model.lastName}}
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>E-mail:</label></div>
						</div>
						<div class="well">
							<div class="row">
								<div {{bind-attr class=":col-sm-12 hasEmailError:has-error"}}>
									{{#if hasEmailError}}<label class="control-label" for="name">{{ emailError }}</label>{{/if}}
									{{input placeholder="E-mail" class="form-control" value=model.email}}
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Password:</label></div>
						</div>
						<div class="well">
							<div class="row">
								<div {{bind-attr class=":col-sm-12 hasPasswordError:has-error"}}>
									{{#if hasPasswordError}}<label class="control-label" for="name">{{ passwordError }}</label>{{/if}}
									{{input type="password" placeholder="Password" class="form-control" value=model.password}}
								</div>
							</div>
						</div>
						<label>
							<a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" aria-expanded="true" aria-controls="collapseOne">Advanced</a>
						</label>
						<div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
							<div class="row">
								<div class="col-xs-8"><label>Role:</label></div>
							</div>
							<div class="well">
								<div class="row">
									<div class="col-xs-12">{{view "select" content=roles optionValuePath="content.value" optionLabelPath="content.name"value=model.role prompt="Roles"}}</div>
								</div>
							</div>
						</div>
					</div>
				</form>
			{{/popup-window}}
		</script>

		<script type="text/x-handlebars" id="user">
			{{#popup-window title="Profile" link='users' saveButton=false}}
				<div class="row">
					<div class="col-xs-6">
						<div class="row">
							<div class="col-xs-8"><label>First name:</label></div>
							<div class="col-xs-4">{{model.firstName}}</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Last name:</label></div>
							<div class="col-xs-4">{{model.lastName}}</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>E-mail:</label></div>
							<div class="col-xs-4">{{model.email}}</div>
						</div>
						<div class="row">
							<div class="col-xs-8"><label>Role:</label></div>
							<div class="col-xs-4">{{model.role}}</div>
						</div>
					</div>
					<div class="col-xs-offset-2 col-xs-3">
						<img src="profile.png" class="img-rounded" alt="Cinque Terre" width="100%">
					</div>
				</div>
			{{/popup-window}}
		</script>

        <script type="text/x-handlebars" id="unauthorised">
            <div class="alert alert-danger" role="alert">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                <span class="sr-only">Error:</span>
                <p>You are unauthorised to view this page!</p>
            </div>
        </script>

		<script type="text/x-handlebars" id="login">
			<div class='login'>
				<div class='wrapper'>
					<div class='row'>
						<div class='col-lg-12'>
							<div class='brand text-center'>
								<h1>
									<div class='logo-icon cros-logo'>
										<i class=''></i>
									</div>
								</h1>
							</div>
						</div>
					</div>
					<div class='row'>
						<div class='col-lg-12'>
							<form>
								<fieldset class='text-center'>
									<legend>Login to your account</legend>
									<div {{bind-attr class=":form-group hasEmailError:has-error"}}>
                                        {{#if hasEmailError}}<label class="control-label" for="email">{{ emailError }}</label>{{/if}}
										{{input value=emailInput placeholder="Email address" type="text" class='form-control' id='email'}}
									</div>
									<div {{bind-attr class=":form-group hasPasswordError:has-error"}}>
                                        {{#if hasPasswordError}}<label class="control-label" for="password">{{ passwordError }}</label>{{/if}}
										{{input value=passwordInput placeholder="Password" type="password" class='form-control' id='password' }}
									</div>
									<div class='text-center'>
										<!--<div class='checkbox'>
											<label>
												<input type='checkbox'>
												Remember me on this computer
											</label>
										</div>-->
										<button class="btn btn-default" {{ action 'login' }}>Sign in</button>
									</div>
                                    <div class="text-center">
                                        <a href="javascript:;" data-toggle="popover" data-placement="left" title="forgot" data-content="If you forgot your password, please contact the administrator.">Forgot password?</a>
                                        <a href="javascript:;" data-toggle="popover" title="register" data-content="Contact your system administrator to add new accounts">Register</a>
                                    </div>
								</fieldset>
							</form>
						</div>
					</div>
				</div>
			</div>
		</script>

        <script type="text/x-handlebars" id="unavailable">
            <div class='login'>
                <div class='wrapper'>
                    <div class='row'>
                        <div class='col-lg-12'>
                            <div class='brand text-center'>
                                <h1>
                                    <div class='logo-icon cros-logo'>
                                        <i class=''></i>
                                    </div>
                                </h1>
                            </div>
                        </div>
                    </div>
                    <div class='row'>
                        <div class='col-lg-12 text-center has-error'>
                            <label class="control-label">We are sorry. Our server seems to be unavailable...</label>
                            <div class="unavailable"></div>
                        </div>
                    </div>
                </div>
            </div>
        </script>


        <!---------------------------------Components--------------------------------->
        <script type="text/x-handlebars" id="components/my-table">
            <div class="panel panel-default grid">
                <div class="panel-heading">
                    {{#if userCanEdit}}
                    <div class="row">
                        <div class="col-xs-12">
                            {{#link-to addLink class='btn-sm btn-success pull-right'}}
                            <i class="fa fa-plus"></i>
                            {{/link-to}}
                        </div>
                    </div>
                    {{/if}}
                </div>
                <div class="panel-body filters">
                    <div class="row">
                        <div class="col-md-7">
                            <div class="input-group">
                                <p>Number of items:</p>
                                {{view "select" id="perPage" content= nrOfElements optionValuePath="content.value" optionLabelPath="content.label" value=perPage}}
                            </div>
                        </div>
                        <div class="col-md-2">
                            {{view "select" id="searchFields" class="form-control" content=searchFields value=searchField}}
                        </div>
                        <div class="col-md-3 pull-right">
                            <div class="input-group">
                                {{input class="form-control" id="searchbox" valueBinding='keyword' type="text" placeholder="Search..." action='search'}}
                                <span class="input-group-btn">
                                    <button class="btn" type="button" {{action 'search' keyword}}>
                                        <i class="fa fa-search"></i>
                                    </button>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <table class="table">
                    <thead>
                    <tr>
                        {{#each column in columns itemController='column'}}
                            {{#if column.sortable}}
                                <th><a class="btn" id="customTableHeader" {{action "sort" column.value}}>{{column.label}} {{#if column.sortable}} <i {{bind-attr class="column.getIconClass"}}></i>{{/if}}</a></th>
                            {{else}}
                                <th>{{column.label}}</th>
                            {{/if}}
                        {{/each}}
                    </tr>
                    </thead>
                    {{yield}}
                </table>
                {{#if hasPages}}
                <div class="panel-footer">
                    <ul class="pagination pagination-sm">
                        {{#if prevPage}}
                            <li><a href="#" {{action "selectPage" prevPage}}>&laquo;</a></li>
                        {{else}}
                            <li class="disabled"><a>&laquo;</a></li>
                        {{/if}}

                        {{#each p in pages itemController="page"}}
                            <li {{bind-attr class="p.active disabled"}}><a href="#" {{action "selectPage" p.number}}>{{p.number}}</a></li>
                        {{/each}}

                        {{#if nextPage}}
                            <li><a href="#" {{action "selectPage" nextPage}}>&raquo;</a></li>
                        {{else}}
                            <li class="disabled"><a>&raquo;</a></li>
                        {{/if}}
                    </ul>
                    <div class="pull-right">
                        Showing {{begin}} to {{end}} of {{length}} entries
                    </div>
                </div>
                {{/if}}
                {{#if isEmpty}}
                    <div class="panel-footer">
                        <div class="text-center"><em >There are no elements found.</em></div>
                    </div>
                {{/if}}
            </div>
        </script>

		<script type="text/x-handlebars" data-template-name="components/popup-window">
			<div class="modal fade">
				<div class="modal-dialog" {{ bind-attr style=sizeStyle }}>
					<div class="modal-content">
						<div class="modal-header">
							{{#link-to link id='closeModal' class='close'}}&times;{{/link-to}}
							<h4 class="modal-title">{{title}}</h4>
						</div>
						<div class="modal-body">
							{{yield}}
						</div>
						<div class="modal-footer">
							<div class="row">
								<div class="col-xs-4">
                                    {{{footer}}}
								</div>
								<div class="col-xs-4 col-xs-offset-4">
								{{#if saveButton}}
									<div class="btn-group">
										<button {{action 'ok'}} class="btn btn-success">Save</button>
										{{#link-to link class='btn btn-primary'}}Close{{/link-to}}
									</div>
								{{else}}
									{{#link-to link class='btn btn-primary'}}Close{{/link-to}}
								{{/if}}
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</script>

        <script type="text/x-handlebars" id="components/my-map">
            <div {{bind-attr id=mapName}} style="height:365px;"></div>
        </script>

		<script type="text/x-handlebars" id="components/gauge-graph">
			<div id="gauge" class="epoch gauge-tiny graph" ></div>
		</script>

        <script type="text/x-handlebars" id="components/line-graph">
            <div class="epoch category10" id="lineChart" style="width: inherit; height: 150px"></div>
        </script>

        <script type="text/x-handlebars" id="components/pie-chart">
            {{statuses}}
            <div  class="epoch category2 b" id="pie" style="width: 350px; height: 350px"></div>
        </script>

        <script type="text/x-handlebars" id="components/user-display">
            <ul class="nav navbar-nav pull-right">
                <li class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="javascript:;">
                        <i class="fa fa-user" id="toggle"></i>
                        <i class="icon-envelope"></i>
                        <strong>{{fullName}}</strong>
                        <b class="caret"></b>
                    </a>
                    <ul class="dropdown-menu">
                        <li>
                            {{#link-to "user" userId}}Info{{/link-to}}
                        </li>
                        <li>
                            <a href="javascript:;" {{action 'logout' }}>Log out</a>
                        </li>
                    </ul>
                </li>
            </ul>
        </script>

        <script type="text/x-handlebars" id="components/manual-control">
            {{{title}}}
        </script>

		<script src="js/libs/jquery-2.1.3.min.js"></script>
		<script src="js/libs/bootstrap.min.js"></script>
		<script src="js/libs/jquery.cookie.js"></script>
		<script src="js/libs/ember-template-compiler-1.10.0.js"></script>
		<script src="js/libs/ember-1.10.0.debug.js"></script>
		<script src="js/libs/ember-data.js"></script>
		<script src='js/libs/nprogress.js'></script>
		<script src="js/libs/leaflet.js"></script>
		<script src="js/libs/d3.js"></script>
		<script src="js/libs/epoch.min.js"></script>

        <script src="js/authManager.js"></script>
		<script src="js/app.js"></script>
		<script src="js/adapter.js"></script>
		<script src="js/socketmanager.js"></script>
		<script src="js/test.js"></script>
        <script src="js/routers/superRouter.js"></script>
		<script src="js/router.js"></script>
        <script src="js/routers/assignmentsRouter.js"></script>
        <script src="js/routers/basestationsRouter.js"></script>
        <script src="js/routers/dronesRouter.js"></script>
        <script src="js/routers/usersRouter.js"></script>
		<script src="js/models/drone.js"></script>
        <script src="js/controllers/listsController.js"></script>
        <script src="js/controllers/appcontroller.js"></script>
        <script src="js/controllers/dashboardController.js"></script>
        <script src="js/controllers/loginController.js"></script>
		<script src="js/controllers/droneController.js"></script>
        <script src="js/controllers/dronesController.js"></script>
        <script src="js/controllers/assignmentController.js"></script>
        <script src="js/controllers/assignmentsController.js"></script>
        <script src="js/controllers/basestationController.js"></script>
        <script src="js/controllers/basestationsController.js"></script>
        <script src="js/controllers/usersController.js"></script>
        <script src="js/controllers/userController.js"></script>
        <script src="js/controllers/checkpointController.js"></script>
        <script src="js/components/tableController.js"></script>
		<script src="js/components/popup.js"></script>
		<script src="js/components/map.js"></script>
        <script src="js/components/popupMap.js"></script>
        <script src="js/components/maps/dashboardMap.js"></script>
        <script src="js/components/maps/DroneMap.js"></script>
        <script src="js/components/maps/basestationMap.js"></script>
        <script src="js/components/maps/basestationAddMap.js"></script>
        <script src="js/components/maps/assignmentMap.js"></script>
        <script src="js/components/maps/assignmentsAddMap.js"></script>
        <script src="js/components/userdisplay.js"></script>
		<script src="js/components/charts/gaugeGraph.js"></script>
        <script src="js/components/charts/lineChart.js"></script>
        <script src="js/components/charts/pieChart.js"></script>
        <script src="js/components/ManualControl.js"></script>
	</body>
</html>
